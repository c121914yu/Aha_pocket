{"version":3,"sources":["uni-app:///main.js","webpack:///D:/服务外包/竞赛统计/pages/Resource/UpResource.vue?0e9f","webpack:///D:/服务外包/竞赛统计/pages/Resource/UpResource.vue?0e85","webpack:///D:/服务外包/竞赛统计/pages/Resource/UpResource.vue?d998","webpack:///D:/服务外包/竞赛统计/pages/Resource/UpResource.vue?0ec1","uni-app:///pages/Resource/UpResource.vue","webpack:///D:/服务外包/竞赛统计/pages/Resource/UpResource.vue?ccd0","webpack:///D:/服务外包/竞赛统计/pages/Resource/UpResource.vue?c308"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,yG;AACAA,UAAU,CAACC,mBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuH;AACvH;AAC8D;AACL;AACgB;;;AAGzE;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,qFAAM;AACR,EAAE,8FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,yFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAomB,CAAgB,8nBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC6ExnB,oF;;AAEA;AACA,MADA,kBACA;AACA;AACA;AACA;AACA;AACA,eADA;AAEA,oBAFA,EAEA;AACA,uBAHA,EAGA;AACA,oBAJA;AAKA,kBALA;AAMA,iBANA;AAOA,mBAPA,EAOA;AACA,yBARA;AASA,uBATA;AAUA,qBAVA,EAUA;AACA,4DAXA,EAWA;AACA,8CAZA,EAYA;AACA,0BAbA;AAcA,8BAdA;AAeA,mBAfA;;AAiBA,GAtBA;AAuBA;AACA;;;;;;;AAOA,QARA;AASA;AACA;AACA,KAXA,EAvBA;;AAoCA;AACA;;;;;;;AAOA,YARA;AASA;AACA;AACA,gBADA;AAEA,yBAFA;AAGA,6BAHA;AAIA,iBAJA;AAKA,sBALA;;AAOA,KAjBA;AAkBA;;;;;;;;;AASA,cA3BA,sBA2BA,KA3BA;AA4BA;AACA;AACA,gBADA,EACA;AACA,4CAFA,EAEA;AACA;AACA;AACA,SALA;;AAOA,KApCA;AAqCA;;;;;;;;;;AAUA,gBA/CA,wBA+CA,GA/CA,EA+CA,KA/CA;AAgDA;AACA;AACA;AACA;AACA,OAHA;;AAKA;AACA;AACA;AACA,KAzDA;AA0DA;;;;;;;;AAQA,eAlEA,uBAkEA,GAlEA;AAmEA;AACA;AACA,mBADA;;AAGA,KAvEA;AAwEA;;;;;;;;;AASA,eAjFA,uBAiFA,KAjFA;AAkFA;AACA;AACA,kBADA;AAEA;AACA;AACA,OAJA;;AAMA,KAzFA;AA0FA;;;;;AAKA,cA/FA;AAgGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBADA;;AAGA;AACA;AACA,gBADA;AAEA,mBAFA;AAGA;AACA;AACA;AACA,6BADA;AAEA,4BAFA;AAGA,yCAHA;;AAKA,WANA;AAOA,SAXA;AAYA;AACA;AACA;AACA,SAfA;AAgBA;AACA;AACA,SAlBA;;AAoBA,KAlIA;AAmIA;;;;;;;;;AASA,cA5IA,sBA4IA,KA5IA;AA6IA;AACA;AACA,kCADA;AAEA;AACA;AACA,OAJA;;AAMA,KApJA;AAqJA,UArJA,kBAqJA,IArJA;AAsJA;AACA;AACA;AACA,KAzJA;AA0JA;;;;;;;AAOA,cAjKA;AAkKA;AACA;AACA;AACA,yBADA;AAEA,mCAFA;AAGA,+BAHA;AAIA,uBAJA;AAKA,6DALA;AAMA,mCANA;AAOA,yCAPA;AAQA,iEARA;AASA,qCATA;;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAlOA;AAmOA;;;;;AAKA,eAxOA;AAyOA;AACA;AACA,yBADA;AAEA,kBAFA;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UADA,CACA;AACA;AACA,2BADA;AAEA,oBAFA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cADA,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WATA;AAUA,eAVA,CAUA;AACA;AACA;AACA,WAbA;AAcA,SAlBA;;AAoBA;AACA;AACA;AACA,cADA,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WATA;AAUA,eAVA,CAUA;AACA;AACA;AACA,WAbA;AAcA,SAfA;AAgBA,OA7CA;AA8CA,WA9CA,CA8CA;AACA;AACA;AACA,OAjDA;AAkDA,KAvSA;AAwSA;;;;;;AAMA,WA9SA,mBA8SA,IA9SA;AA+SA;AACA;AACA;AACA;AACA,UADA,CACA;AACA;AACA;AACA,OAJA;AAKA;AACA,KAxTA,EApCA;;AA8VA,QA9VA,oBA8VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAzWA;AA0WA;AACA,wBADA,EA1WA,E;;;;;;;;;;;;;AC/EA;AAAA;AAAA;AAAA;AAA4mC,CAAgB,ulCAAG,EAAC,C;;;;;;;;;;;ACAhoC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/Resource/UpResource.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/Resource/UpResource.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./UpResource.vue?vue&type=template&id=08607481&\"\nvar renderjs\nimport script from \"./UpResource.vue?vue&type=script&lang=js&\"\nexport * from \"./UpResource.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UpResource.vue?vue&type=style&index=0&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/Resource/UpResource.vue\"\nexport default component.exports","export * from \"-!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./UpResource.vue?vue&type=template&id=08607481&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./UpResource.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./UpResource.vue?vue&type=script&lang=js&\"","<!-- 资源分享 -->\r\n<template>\n\t<view class=\"up-resource\">\r\n\t\t<view class=\"content\">\r\n\t\t\t<view class=\"h3\">资源信息</view>\r\n\t\t\t<inputInfo \r\n\t\t\t\ttitle=\"标题\"\r\n\t\t\t\tcontentWidth=\"80%\"\r\n\t\t\t\tv-model=\"title\">\r\n\t\t\t</inputInfo>\r\n\t\t\t<inputInfo\r\n\t\t\t\ttitle=\"作者\"\r\n\t\t\t\tcontentWidth=\"200rpx\"\r\n\t\t\t\tv-model=\"authorName\">\r\n\t\t\t</inputInfo>\r\n\t\t\t<inputInfo\r\n\t\t\t\ttitle=\"联系方式\"\r\n\t\t\t\tv-model=\"authorContact\">\r\n\t\t\t</inputInfo>\r\n\t\t\t<inputInfo\r\n\t\t\t\ttitle=\"完成程度\"\r\n\t\t\t\ttype=\"select\"\r\n\t\t\t\tcontentWidth=\"350rpx\"\r\n\t\t\t\t:range=\"finishRates\"\r\n\t\t\t\tv-model=\"finishRate\">\r\n\t\t\t</inputInfo>\r\n\t\t\t<inputInfo\r\n\t\t\t\ttitle=\"资源类型\"\r\n\t\t\t\ttype=\"select\"\r\n\t\t\t\tcontentWidth=\"350rpx\"\r\n\t\t\t\t:range=\"AccessoriesClassify\"\r\n\t\t\t\tv-model=\"classify\">\r\n\t\t\t</inputInfo>\r\n\t\t\t<inputInfo\r\n\t\t\t\ttitle=\"标签\"\r\n\t\t\t\tcontentWidth=\"80%\"\r\n\t\t\t\tremark=\"(注: 不同标签用空格隔开)\"\r\n\t\t\t\tv-model=\"tagText\">\r\n\t\t\t</inputInfo>\r\n\t\t\t<view class=\"tags\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tclass=\"tag\"\r\n\t\t\t\t\tv-for=\"(tag,index) in tags\"\r\n\t\t\t\t\t:key=\"index\">\r\n\t\t\t\t\t{{tag}}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\r\n\t\t\t<!-- 获奖情况 -->\r\n\t\t\t<view class=\"input-info\">\r\n\t\t\t\t<view class=\"h4\">获奖情况:</view>\r\n\t\t\t\t<view class=\"prize\">\r\n\t\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t\t<view class=\"name\">比赛名称</view>\r\n\t\t\t\t\t\t<view class=\"date\">获奖日期</view>\r\n\t\t\t\t\t\t<view class=\"level\">获奖等级</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t\t<text class=\"add iconfont icon-tianjia\"></text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<!-- 附件列表 -->\r\n\t\t\t<view class=\"input-info\">\r\n\t\t\t\t<view class=\"h4\">附件列表:</view>\r\n\t\t\t\t<view class=\"accessories\">\r\n\t\t\t\t\t<text class=\"iconfont icon-tianjia\" @click=\"chooseFile\"></text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"remark\">(注:手机选择文件可从文件助手或聊天记录中选取，超过25M文件请用电脑选取。)</view>\r\n\t\t\t</view>\r\n\t\t\t<!-- 资源描述 -->\r\n\t\t\t<view class=\"h4\">资源描述:</view>\r\n\t\t</view>\r\n\t</view>\n</template>\n\n<script>\r\nimport { getOssSignature,postResource } from \"@/static/request/api_resource.js\"\r\nimport inputInfo from \"./components/inputInfo.vue\"\r\nexport default {\n\tdata() {\r\n\t\tconst AccessoriesClassify = getApp().globalData.AccessoriesClassify\r\n\t\tconst MatchName = getApp().globalData.MatchName\r\n\t\tconst prizeGrades = getApp().globalData.prizeGrades\n\t\treturn {\r\n\t\t\ttitle: \"\",\r\n\t\t\tauthorName: \"\", // 作者名称\r\n\t\t\tauthorContact: \"\", // 作者联系方式\r\n\t\t\tfinishRate: \"\",\r\n\t\t\tclassify: \"\",\r\n\t\t\ttagText: \"\",\r\n\t\t\tprizeList: [], // 获奖情况\r\n\t\t\tdescriptionHTML: \"\",\r\n\t\t\tdescriptionMD: \"\",\r\n\t\t\taccessories: [], // 附件\r\n\t\t\tfinishRates: [\"100%\",\"80%-100%\",\"50%-80%\",\"0%-50%\"], // 完成度数组\r\n\t\t\tAccessoriesClassify, // 资源类型\r\n\t\t\tMatchName,\r\n\t\t\tprizeGrades,\r\n\t\t\tisEdit: false\n\t\t}\n\t},\r\n\tcomputed: {\r\n\t\t/*\r\n\t\t\tdesc: 监听输入标签内容改变，根据空格分隔\r\n\t\t\tinput: \r\n\t\t\t\t\t\ttagText: String,标签输入框内容\r\n\t\t\treturn: null\r\n\t\t\ttime: 2020/11/5\r\n\t\t*/\r\n\t\ttags()\r\n\t\t{\r\n\t\t\treturn this.tagText.split(\" \").filter(tag => tag !== \"\")\r\n\t\t},\r\n\t},\r\n\tmethods: {\r\n\t\t/*\r\n\t\t\tname: 添加获奖\r\n\t\t\tdesc: 追加一个获奖情况，包括名称，赛事，获奖等级，如果是自建赛事还需要选择赛事分类。\r\n\t\t\tchange: \r\n\t\t\t\t\t\t\tthis.prizeList: Array,获奖数组\r\n\t\t\ttime: 2020/10/25\r\n\t\t*/\r\n\t\taddPrize()\r\n\t\t{\r\n\t\t\tthis.prizeList.push({\r\n\t\t\t\tname: \"\",\r\n\t\t\t\tmatchClassify: \"\",\r\n\t\t\t\tisShowClassify: false,\r\n\t\t\t\tlevel: \"\",\r\n\t\t\t\ttestifyUrl: \"\"\r\n\t\t\t})\r\n\t\t},\r\n\t\t/*\r\n\t\t\tname: 添加获奖证明\r\n\t\t\tdesc: 添加一个获奖证明图片\r\n\t\t\tinput:\r\n\t\t\t\t\t\tindex: Number,获奖数组下标\r\n\t\t\tchange: \r\n\t\t\t\t\t\t\tthis.prizeList[index].testifyUrl: String,获奖证明\r\n\t\t\ttime: 2020/10/25\r\n\t\t*/\r\n\t\taddTestify(index)\r\n\t\t{\r\n\t\t\tuni.chooseImage({\r\n\t\t\t\tcount: 1, //默认9\r\n\t\t\t\tsizeType: ['original', 'compressed'], //可以指定是原图还是压缩图，默认二者都有\r\n\t\t\t\tsuccess:  (img) => {\r\n\t\t\t\t\tthis.prizeList[index].testifyUrl = img.tempFilePaths[0]\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t/*\r\n\t\t\tname: 输入比赛名称结束\r\n\t\t\tdescription: 获取比赛名称，与库中已有比赛配对，若不存在则表示为自建，需要用户选择分类\r\n\t\t\tinput: \r\n\t\t\t\t\t\tval: String,输入内容\r\n\t\t\t\t\t\tindex: Numnber,对应数组 下标\r\n\t\t\tchange:\r\n\t\t\t\t\t\t\tprizeList[index].isShowClassify: Boolean,是否展示分类\r\n\t\t\ttime: 2020/10/24\r\n\t\t*/\r\n\t\tblurMathName(val,index)\r\n\t\t{\r\n\t\t\tif(this.MatchName.indexOf(val) === -1 && val !== \"\")\r\n\t\t\t{\r\n\t\t\t\tthis.prizeList[index].isShowClassify = true\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tthis.prizeList[index].isShowClassify = false\r\n\t\t\t}\r\n\t\t},\r\n\t\t/*\r\n\t\t\tname: 查看获奖证明\r\n\t\t\tdesc: 查看获奖证明图片\r\n\t\t\tinput:\r\n\t\t\t\t\t\turl: String,证明链接地址\r\n\t\t\tchange: \r\n\t\t\ttime: 2020/10/26\r\n\t\t*/\r\n\t\treadTestify(url)\r\n\t\t{\r\n\t\t\tuni.previewImage({\r\n\t\t\t\turls: [url]\r\n\t\t\t})\r\n\t\t},\r\n\t\t/*\r\n\t\t\tname: 删除获奖情况\r\n\t\t\tdesc: 根据下标删除获奖列表,需要先调用modal提示框\r\n\t\t\tinput:\r\n\t\t\t\t\t\tindex: Number,下标\r\n\t\t\tchange: \r\n\t\t\t\t\t\tthis.prizeList: Array,获奖列表\r\n\t\t\ttime: 2020/10/25\r\n\t\t*/\r\n\t\tremovePrize(index)\r\n\t\t{\r\n\t\t\tthis.gShowModal(\r\n\t\t\t\t'确认删除该获奖记录?',\r\n\t\t\t\t() => {\r\n\t\t\t\t\tthis.prizeList.splice(index,1)\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t},\r\n\t\t/* \r\n\t\t\tname: 选择附件\r\n\t\t\tdescription: 选择需要上传的附件\r\n\t\t\ttime: 2020/10/24\r\n\t\t*/\r\n\t\tchooseFile()\r\n\t\t{\r\n\t\t\tfunction renderSize(fsize){\r\n\t\t\t\tconst unitArr = new Array(\"Bytes\",\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\")\r\n\t\t\t\tlet index = 0\r\n\t\t\t\tlet srcsize = parseFloat(fsize)\r\n\t\t\t\tindex = Math.floor(Math.log(srcsize) / Math.log(1024))\r\n\t\t\t\tlet size = srcsize / Math.pow(1024,index)\r\n\t\t\t\tsize = size.toFixed(2)\r\n\t\t\t\treturn size + unitArr[index]\r\n\t\t\t}\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: \"选择中...\"\r\n\t\t\t})\r\n\t\t\t/* 选择文件API */\r\n\t\t\twx.chooseMessageFile({\r\n\t\t\t  count: 5,\r\n\t\t\t  type: 'all',\r\n\t\t\t  success: (res) => {\r\n\t\t\t\t\tthis.accessories.push(...res.tempFiles.map(file => {\r\n\t\t\t\t\t\treturn{\r\n\t\t\t\t\t\t\tname: file.name,\r\n\t\t\t\t\t\t\turl: file.path,\r\n\t\t\t\t\t\t\tsize: renderSize(file.size)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})) \r\n\t\t\t  },\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\tthis.gToastError(err.errMsg)\r\n\t\t\t\t},\r\n\t\t\t\tcomplete: () => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t/* \r\n\t\t\tname: 删除文件\r\n\t\t\tdesc: 根据下标删除附件列表,需要先调用modal提示框\r\n\t\t\tinput:\r\n\t\t\t\t\t\tindex: Number,下标\r\n\t\t\tchange: \r\n\t\t\t\t\t\tthis.accessories: Array,附件列表\r\n\t\t\ttime: 2020/10/25\r\n\t\t*/\r\n\t\tremoveFile(index)\r\n\t\t{\r\n\t\t\tthis.gShowModal(\r\n\t\t\t\t`确认删除 ${this.accessories[index].name}?`,\r\n\t\t\t\t() => {\r\n\t\t\t\t\tthis.accessories.splice(index,1)\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t},\r\n\t\teditOk(html)\r\n\t\t{\r\n\t\t\tthis.descriptionHTML = html\r\n\t\t\tthis.isEdit = false\r\n\t\t},\r\n\t\t/* \r\n\t\t\tname: 验证输入内容\r\n\t\t\tdesc: 验证输入的资源内容\r\n\t\t\t\t\t\t若是已存在分类则选择分类填充matchClassify的值\r\n\t\t\t\t\t\t去掉isShowClassify\r\n\t\t\t\t\t\t添加testifyName值，取名为 /联系方式/时间戳\r\n\t\t*/\r\n\t  verifyInfo()\r\n\t\t{\r\n\t\t\t/* 整合数据 */\r\n\t\t\tconst data = {\r\n\t\t\t\ttitle: this.title,\r\n\t\t\t\tfinishRate: this.finishRate,\r\n\t\t\t\tclassify: this.classify,\r\n\t\t\t\ttags: this.tags,\r\n\t\t\t\tprizeList:  JSON.parse(JSON.stringify(this.prizeList)),\r\n\t\t\t\tauthorName: this.authorName,\r\n\t\t\t\tauthorContace: this.authorContace,\r\n\t\t\t\taccessories: JSON.parse(JSON.stringify(this.accessories)),\r\n\t\t\t\tdescription: this.description\r\n\t\t\t}\r\n\t\t\tif(data.title === \"\")\r\n\t\t\t{\r\n\t\t\t\tthis.gToastError(\"请输入资源标题\")\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\tif(data.finishRate === \"\")\r\n\t\t\t{\r\n\t\t\t\tthis.gToastError(\"请选择完成程度\")\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\tif(data.classify === \"\")\r\n\t\t\t{\r\n\t\t\t\tthis.gToastError(\"请选择资源类型\")\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\tif(data.authorName === \"\")\r\n\t\t\t{\r\n\t\t\t\tthis.gToastError(\"请输入作者姓名\")\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\tif(data.authorContace === \"\")\r\n\t\t\t{\r\n\t\t\t\tthis.gToastError(\"请输入联系方式\")\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\tif(data.accessories.length === 0)\r\n\t\t\t{\r\n\t\t\t\tthis.gToastError(\"请选择附件\")\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\t/* 判断获奖证明 */\r\n\t\t\tfor(let i=0;i<data.prizeList.length;i++){\r\n\t\t\t\tconst prize = data.prizeList[i]\r\n\t\t\t\tif(prize.name === \"\")\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.gToastError(\"获奖名称为空\")\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif(prize.level === \"\")\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.gToastError(\"获奖等级为空\")\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif(prize.testifyUrl === \"\")\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.gToastError(\"获奖证明为空\")\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tdelete data.prizeList[i].isShowClassify\r\n\t\t\t}\r\n\t\t\treturn data\r\n\t\t},\r\n\t\t/*\r\n\t\t\tname: 上传文件\r\n\t\t\tdesc: 上传证明材料，附件，并对需要提交的数据进行整理\r\n\t\t\ttime: 2020/10/26\r\n\t\t*/\r\n\t\tuploadFiles()\r\n\t\t{\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: \"获取签名中...\",\r\n\t\t\t\tmask: true\r\n\t\t\t})\r\n\t\t\tconst data = this.verifyInfo()\r\n\t\t\tif(!data)\r\n\t\t\t{\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t/* 获取签名 */\r\n\t\t\tgetOssSignature()\r\n\t\t\t.then(signature => {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: \"上传文件中...\",\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t})\r\n\t\t\t\t/* 上传证明材料 */\r\n\t\t\t\tlet successAmount = 0\r\n\t\t\t\tdata.prizeList.forEach((prize,i) => {\r\n\t\t\t\t\t/* 检测类型，仅支持jpg,jpeg,png */\r\n\t\t\t\t\tconst temp = prize.testifyUrl.split(\".\")\r\n\t\t\t\t\tconst filename = `${Date.now()}.${temp[temp.length-1]}`\r\n\t\t\t\t\tthis.gUploadFile(prize.testifyUrl,filename,signature.data)\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t/* 修改testifyUrl */\r\n\t\t\t\t\t\tprize.testifyUrl = res.url\r\n\t\t\t\t\t\tsuccessAmount++\r\n\t\t\t\t\t\tif(successAmount === (data.prizeList.length + data.accessories.length))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.publish(data)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\tthis.gToastError(\"上传出现错误\")\r\n\t\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\t/* 上传附件 */\r\n\t\t\t\tdata.accessories.forEach((item,i) => {\r\n\t\t\t\t\tthis.gUploadFile(item.url,item.name,signature.data)\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t/* 修改url，指向对应地址 */\r\n\t\t\t\t\t\titem.url = res.url\r\n\t\t\t\t\t\tsuccessAmount++\r\n\t\t\t\t\t\tif(successAmount === (data.prizeList.length + data.accessories.length))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.publish(data)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\tthis.gToastError(\"上传出现错误\")\r\n\t\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t\tthis.gToastError(\"获取签名错误\")\r\n\t\t\t})\r\n\t\t},\r\n\t\t/* \r\n\t\t\tname: 发表资源\r\n\t\t\tdesc: 上传证明和附件后向服务器提交表单\r\n\t\t\tinput:\r\n\t\t\t\t\t\tdata: Object,需要提交的数据\r\n\t\t*/\r\n\t\tpublish(data)\r\n\t\t{\r\n\t\t\tuni.hideLoading()\r\n\t\t\t/* 请求服务器 */\r\n\t\t\tpostResource(data)\r\n\t\t\t.then(res => {\r\n\t\t\t\tconsole.log(res);\r\n\t\t\t\tthis.gToastSuccess(\"上传成功\")\r\n\t\t\t})\r\n\t\t\tconsole.log(data)\r\n\t\t}\r\n\t},\r\n\tonLoad() {\r\n\t\t/* 判断用户是否签署合同，若为签署则跳转签署界面 */\r\n\t\t// if(!getApp().globalData.gUserInfo.signedContract)\r\n\t\t// {\r\n\t\t// \tuni.redirectTo({\r\n\t\t// \t\turl: \"./Contract\",\r\n\t\t// \t\tsuccess: () => {\r\n\t\t// \t\t\tthis.gToastError(\"请先签署合同\")\r\n\t\t// \t\t}\r\n\t\t// \t})\r\n\t\t// }\r\n\t},\r\n\tcomponents: {\r\n\t\tinputInfo\r\n\t}\r\n}\n</script>\n\n<style lang=\"stylus\">\n.up-resource\r\n\tposition relative\r\n\tmin-height 100vh\r\n\tpadding 20rpx\r\n\tbackground-color var(--origin3)\r\n\t.content\r\n\t\tpadding 20rpx 60rpx\r\n\t\tbackground-color #FFFFFF\r\n\t\tborder-radius 44rpx\r\n\t\t/* 大标题 */\r\n\t\t.h3\r\n\t\t\tpadding 20rpx 0\r\n\t\t\tcolor var(--origin1)\r\n\t\t/* 小标题 */\r\n\t\t.h4\r\n\t\t\tcolor var(--origin1)\r\n\t\t/* 输入框 */\r\n\t\t.input-info\r\n\t\t\tmargin 15rpx 0\r\n\t\t/* 标签框 */\r\n\t\t.tags\r\n\t\t\twidth 100%\r\n\t\t\tdisplay flex\r\n\t\t\tflex-wrap wrap\r\n\t\t\t.tag\r\n\t\t\t\tmargin 0 5px 5px 0\r\n\t\t\t\tpadding 0 10rpx\r\n\t\t\t\tborder 1px solid var(--origin2)\r\n\t\t\t\tborder-radius 20rpx\r\n\t\t/* 备注信息 */\r\n\t\t.remark\r\n\t\t\tcolor var(--origin2)\r\n\t\t\tfont-size 20rpx\r\n\t\t/* 资源列表 */\r\n\t\t.accessories\r\n\t\t\tposition relative\r\n\t\t\twidth 100%\r\n\t\t\tmin-height 100px\r\n\t\t\tpadding 15rpx\r\n\t\t\tbackground-color var(--origin3)\r\n\t\t\tborder-radius 20rpx\r\n\t\t\t.iconfont\r\n\t\t\t\tposition absolute\r\n\t\t\t\ttop 50%\r\n\t\t\t\tleft 50%\r\n\t\t\t\ttransform translate(-50%,-50%)\r\n\t\t\t\tcolor var(--origin2)\r\n\t\t\t\tfont-size 40rpx\r\n\t\t\t\tfont-weight 600\r\n\t\t/* 获奖列表 */\r\n\t\t.prize\r\n\t\t\tbackground-color var(--origin2)\r\n\t\t\tborder-radius 10px\r\n\t\t\tdisplay flex\r\n\t\t\t.left\r\n\t\t\t\tflex 1\r\n\t\t\t\tpadding 10px\r\n\t\t\t\tbackground-color var(--origin3)\r\n\t\t\t\tborder-radius 10px\r\n\t\t\t\tdisplay flex\r\n\t\t\t\tflex-wrap wrap\r\n\t\t\t\tview\r\n\t\t\t\t\tpadding 5px 0\r\n\t\t\t\t\tbackground-color #FFFFFF\r\n\t\t\t\t\tcolor var(--origin2)\r\n\t\t\t\t\tborder-radius 22px\r\n\t\t\t\t\ttext-align center\r\n\t\t\t\t\tfont-size 24rpx\r\n\t\t\t\t.name\r\n\t\t\t\t\twidth 100%\r\n\t\t\t\t.date\r\n\t\t\t\t\tmargin 10px 10px 0 0\r\n\t\t\t\t\tflex 1\r\n\t\t\t\t.level\r\n\t\t\t\t\tmargin-top 10px\r\n\t\t\t\t\tflex 1\r\n\t\t\t.right\r\n\t\t\t\twidth 50px\r\n\t\t\t\tdisplay flex\r\n\t\t\t\tflex-direction column\r\n\t\t\t\talign-items center\r\n\t\t\t\tjustify-content space-around\r\n\t\t\t\t.iconfont\r\n\t\t\t\t\tfont-size 40rpx\r\n\t\t\t\t\tfont-weight 600\r\n\t\t\t\t\tborder-radius 50%\r\n\t\t\t\t\t&.add\r\n\t\t\t\t\t\tcolor var(--origin1)\r\n</style>\n","import mod from \"-!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--11-oneOf-1-0!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--11-oneOf-1-1!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--11-oneOf-1-2!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--11-oneOf-1-3!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\stylus-loader\\\\index.js??ref--11-oneOf-1-4!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--11-oneOf-1-5!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./UpResource.vue?vue&type=style&index=0&lang=stylus&\"; export default mod; export * from \"-!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--11-oneOf-1-0!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--11-oneOf-1-1!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--11-oneOf-1-2!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--11-oneOf-1-3!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\stylus-loader\\\\index.js??ref--11-oneOf-1-4!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--11-oneOf-1-5!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./UpResource.vue?vue&type=style&index=0&lang=stylus&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1604928230020\n      var cssReload = require(\"G:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}